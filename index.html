<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Login</title>
    <link rel="stylesheet" href="css/bootstrap.css"> <!-- 부트스트랩에서 제공하는 css파일을 이용하겠다-->
<!--    <link rel="stylesheet" href="css/site.css">-->
</head>
<body>

<!--md(데스크탑)일때는 4를 차지하고 xs(모바일)일때는 6을 차지하라!-->

<div class="container">

    <!-- Outer Row -->
    <div class="row justify-content-center">

        <div class="col-lg-6 col-md-8 col-md-12 align-self-center">

            <div class="card o-hidden border-0 shadow-lg my-5">
                <div class="card-body p-0">
                    <!-- Nested Row within Card Body -->
                    <div class="row justify-content-center">
                        <div class="col-md-12">
                            <div class="p-5">
                                <div class="text-center">
                                    <h1 class="h4 text-gray-900 mb-4">Welcome!</h1>
                                </div>
                                <form class="user">
                                    <div class="form-group">
                                        <input type="email" class="form-control form-control-user" id="inputID" aria-describedby="emailHelp" placeholder="Id">
                                    </div>
                                    <div class="form-group">
                                        <input type="password" class="form-control form-control-user" id="inputPassword" placeholder="Password">
                                    </div>
                                    <a class="btn btn-primary text-white btn-user btn-block " id="loginButton" onclick="writeUserData();">
                                        Login
                                    </a>
                                    <hr>
                                </form>

<!--                                <div class="text-center">-->
<!--                                    <a class="small" href="forgot-password.html">Forgot Password?</a>-->
<!--                                </div>-->

                                <div class="text-center">
                                    <a class="small" href="register.html">Create an Account!</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<form id = "form1" name = "form1">
    <input type="hidden" name = "id2" id = "id2">
    <input type="hidden" name = "pw2" id = "pw2">
</form>


<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script type="text/javascript" src='/bootstrap.js'></script> <!-- 부트스트랩에서 필요한 자바스크립트를 이용하겠다-->

<!-- The core Firebase JS SDK is always required and must be listed first -->
<script src="https://www.gstatic.com/firebasejs/7.15.0/firebase-app.js"></script>

<!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->
<script src="https://www.gstatic.com/firebasejs/7.15.0/firebase-analytics.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.15.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.15.0/firebase-database.js"></script>




<script>
    // Your web app's Firebase configuration
    var firebaseConfig = {
        apiKey: "AIzaSyAJHIyMYLbLaou3TC9Jxu7bCrvY9mvA5v8",
        authDomain: "inventorysystem-7f9cb.firebaseapp.com",
        databaseURL: "https://inventorysystem-7f9cb.firebaseio.com",
        projectId: "inventorysystem-7f9cb",
        storageBucket: "inventorysystem-7f9cb.appspot.com",
        messagingSenderId: "301963214438",
        appId: "1:301963214438:web:d6db327dab10860852b7a7",
        measurementId: "G-568LQ0P1QB"
    };
    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    firebase.analytics();

    console.log("firebase object --->", firebaseConfig);
    var database = firebase.database();
    console.log(database)
</script>

<script>
    // 로그인 버튼

    document.getElementById('loginButton').onclick = function () {
        console.log("Here is loginButton !!!");

        var id = document.getElementById("inputID").value;
        var password = document.getElementById("inputPassword").value;

        var dbUserRef = database.ref().child('/User');
        var this_user_business_name = "";

        var result = false;
        var userKey = "";

        dbUserRef.once("value")
            .then(function (snapshot) {
                snapshot.forEach(function (childSnapshot) {
                    var childData = childSnapshot.val();
                    if (childData.id == id && childData.password ==password) {
                        result = true;
                        userKey = childSnapshot.key;
                    }
                });
                if (result){
                    location.href = "home.html?userKey="+userKey;
                    console.log("로그인 성공!");
                }else{
                    alert("아이디나 비밀번호 오류입니다.")
                }
            });

    }

</script>



</body>
</html>